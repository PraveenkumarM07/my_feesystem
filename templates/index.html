<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Portal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #2c3e50;
            --success-color: #27ae60;
            --error-color: #e74c3c;
            --background-color: #f5f6fa;

            /* Updated Color Variables */
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.9);
            --text-muted: rgba(255, 255, 255, 0.7);
            --bg-dark: #1a1a1a;
            --bg-darker: #121212;
            --accent-color: #4f46e5;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', sans-serif;
        }

        body {
            background: var(--bg-dark);
            color: var(--text-primary);
        }

        /* Login Form Styles */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            background: var(--bg-darker);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Main App Styles */
        .main-app {
            display: none;
        }

        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            height: 100%;
            width: 250px;
            background: var(--secondary-color);
            padding-top: 60px;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .sidebar.active {
            transform: translateX(0);
        }

        .sidebar a {
            display: block;
            padding: 15px 25px;
            color: white;
            text-decoration: none;
            font-size: 16px;
            transition: 0.2s;
        }

        .sidebar a:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .sidebar a i {
            margin-right: 10px;
        }

        /* Content Area Styles */
        .content-area {
            margin-left: 0;
            padding: 20px;
            transition: margin-left 0.3s ease;
        }

        .content-area.shifted {
            margin-left: 250px;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent-color);
            background: rgba(255, 255, 255, 0.15);
        }

        .form-control::placeholder {
            color: var(--text-muted);
        }

        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            background: var(--primary-color);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s ease;
        }

        .btn:hover {
            background: #357abd;
        }

        /* Menu Toggle Button */
        .menu-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            font-size: 24px;
            cursor: pointer;
            z-index: 1000;
            color: var(--secondary-color);
            display: none;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }

            .content-area.shifted {
                margin-left: 0;
            }
        }

        /* Table Styles */
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            background: var(--bg-darker);
            border-radius: 8px;
            overflow: hidden;
        }

        .table th {
            background: var(--accent-color);
            color: var(--text-primary);
            font-weight: 600;
        }

        .table td {
            padding: 1rem;
            text-align: left;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }

        .table tr:hover td {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Card Styles */
        .card {
            background: var(--bg-darker);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Hide all pages initially */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .badge {
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-weight: 600;
            display: inline-block;
        }

        .bg-success {
            background: linear-gradient(135deg, #27ae60, #1e8449);
            color: white;
        }

        #transactionInfoTable {
            width: 100%;
            margin-top: 1rem;
        }

        #transactionInfoTable th {
            width: 30%;
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            color: white;
            padding: 1rem;
        }

        #transactionInfoTable td {
            padding: 1rem;
        }

        #transactionInfoDisplay {
            margin-top: 2rem;
            padding: 1rem;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .hidden {
            display: none;
        }

        .status-container {
            margin-top: 1.5rem;
        }

        .status-filters {
            margin-bottom: 1.5rem;
        }

        .transaction-card {
            background: var(--bg-darker);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .transaction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .transaction-header h4 {
            color: var(--text-primary);
        }

        .transaction-date {
            color: #666;
            font-size: 0.9rem;
        }

        .transaction-status {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-verified {
            background: #d4edda;
            color: #155724;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .transaction-details {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e1e1e1;
        }

        .transaction-details dl {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .transaction-details dt {
            color: #666;
            font-weight: 600;
        }

        .rejection-reason {
            margin-top: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #dc3545;
        }

        .transaction-card {
            background: var(--bg-darker);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .transaction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e1e1e1;
        }

        .transaction-status {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-verified {
            background: #d4edda;
            color: #155724;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .transaction-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .detail-group {
            margin-bottom: 1rem;
        }

        .detail-label {
            font-size: 0.875rem;
            color: var(--text-muted);
            margin-bottom: 0.25rem;
        }

        .detail-value {
            font-weight: 600;
            color: var(--text-primary);
        }

        .rejection-reason {
            grid-column: 1 / -1;
            margin-top: 1rem;
            padding: 1rem;
            background: #fff5f5;
            border-left: 4px solid #dc3545;
            border-radius: 4px;
        }

        .verification-details {
            grid-column: 1 / -1;
            margin-top: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .verification-details h4 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .transaction-list {
            margin-top: 1rem;
        }

        .text-center {
            text-align: center;
        }

        .status-card {
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .status-card.verified {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .status-card.rejected {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .status-card.pending {
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            color: #856404;
        }

        .student-basic-info,
        .fee-details-section,
        .payment-history-section {
            background: var(--bg-darker);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .info-item {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .info-item:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .info-label {
            font-weight: 600;
            color: var(--text-muted);
            margin-bottom: 5px;
            display: block;
        }

        .info-value {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 700;
        }

        .fee-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .fee-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .fee-item:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .year-wise-section {
            background: var(--bg-darker);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .year-wise-section .section-title {
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--accent-color);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .year-wise-section .fee-summary {
            margin-top: 1.5rem;
        }

        .fee-breakdown-section {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: var(--bg-darker);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .fee-breakdown-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .fee-breakdown-item:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .fee-type {
            color: var(--text-primary);
        }

        .fee-amount {
            color: var(--text-primary);
            font-weight: 700;
        }

        .payment-history {
            margin-top: 1.5rem;
        }

        .year-wise-section h4 {
            color: #4a5568;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .fee-container {
            display: grid;
            gap: 10px;
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
        }

        .fee-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .fee-label {
            font-weight: 600;
            color: var(--text-muted);
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .status-badge.paid {
            background: #d1fae5;
            color: #065f46;
        }

        .status-badge.pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-badge.verified {
            background: #d1fae5;
            color: #065f46;
        }

        .status-badge.rejected {
            background: #fee2e2;
            color: #991b1b;
        }

        .table-responsive {
            overflow-x: auto;
            background: var(--bg-darker);
        }

        @media (max-width: 768px) {

            .info-grid,
            .fee-details {
                grid-template-columns: 1fr;
            }

            .search-box {
                flex-direction: column;
            }

            .search-box .btn {
                width: 100%;
                margin-top: 10px;
            }
        }

        /* Add these styles to your existing CSS */
        .alert {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px;
            border-radius: 4px;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .transaction-success {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .transaction-details {
            margin-top: 15px;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .status-badge.pending {
            background-color: #fff3cd;
            color: #856404;
        }

        .status-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .status-card {
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .status-card.pending {
            border-left: 4px solid #f1c40f;
        }

        .status-card.verified {
            border-left: 4px solid #2ecc71;
        }

        .status-card.rejected {
            border-left: 4px solid #e74c3c;
        }

        .toast-message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 2rem;
            border-radius: 4px;
            background: var(--bg-darker);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }

        .toast-message.success {
            background: #2ecc71;
            color: white;
        }

        .fee-breakdown-section {
            margin-top: 2rem;
            background: var(--bg-darker);
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .fee-type-details {
            display: grid;
            gap: 1rem;
            margin-top: 1rem;
        }

        .fee-breakdown-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .fee-type {
            font-weight: 600;
            color: var(--text-primary);
        }

        .fee-amount {
            color: var(--text-primary);
            font-weight: 700;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.875rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-badge.verified {
            background: #d1fae5;
            color: #065f46;
        }

        .table-responsive {
            overflow-x: auto;
            margin-top: 1rem;
        }

        /* Modern Color Scheme and Styling */
        :root {
            /* Primary Colors */
            --primary-gradient: linear-gradient(135deg, #4f46e5, #06b6d4);
            --secondary-gradient: linear-gradient(135deg, #3b82f6, #2563eb);
            --accent-gradient: linear-gradient(135deg, #ff7eb3, #ff758c);

            /* Background Colors */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;

            /* Text Colors */
            --text-primary: #08d4ea;
            --text-secondary: #3d8ba1;
            --text-muted: #94a3b8;

            /* Status Colors */
            --success-gradient: linear-gradient(135deg, #10b981, #059669);
            --warning-gradient: linear-gradient(135deg, #f59e0b, #d97706);
            --error-gradient: linear-gradient(135deg, #ef4444, #dc2626);

            /* Card & Container Colors */
            --card-bg: rgba(255, 255, 255, 0.9);
            --card-border: rgba(255, 255, 255, 0.3);
            --container-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Apply Colors to Existing Elements */
        body {
            background: var(--bg-dark);
            color: var(--text-primary);
        }

        .login-container {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1), rgba(6, 182, 212, 0.1));
        }

        .login-card {
            background: var(--bg-darker);
            backdrop-filter: blur(12px);
            border: 1px solid var(--card-border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .sidebar {
            background: var(--primary-gradient);
            backdrop-filter: blur(12px);
        }

        .sidebar a {
            color: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }

        .sidebar a:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .card {
            background: var(--bg-darker);
            backdrop-filter: blur(12px);
            border: 1px solid var(--card-border);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .btn {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(79, 70, 229, 0.4);
        }

        .form-control {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: #4f46e5;
            box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
        }

        /* Status Badges */
        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 600;
        }

        .status-badge.verified {
            background: var(--success-gradient);
            color: white;
        }

        .status-badge.pending {
            background: var(--warning-gradient);
            color: white;
        }

        .status-badge.rejected {
            background: var(--error-gradient);
            color: white;
        }

        /* Table Styling */
        .table {
            background: var(--bg-darker);
            border-radius: 12px;
            overflow: hidden;
        }

        .table th {
            background: var(--primary-gradient);
            color: white;
            font-weight: 600;
        }

        .table tr:hover {
            background: rgba(79, 70, 229, 0.05);
        }

        /* Fee Details Cards */
        .fee-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }

        .fee-item:hover {
            transform: translateY(-3px);
        }

        .info-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }

        .info-item:hover {
            transform: translateY(-3px);
        }

        /* Toast Messages */
        .toast-message {
            background: var(--bg-darker);
            backdrop-filter: blur(12px);
            border: 1px solid var(--card-border);
            box-shadow: var(--container-shadow);
        }

        .toast-message.success {
            background: var(--success-gradient);
            color: white;
        }

        .toast-message.error {
            background: var(--error-gradient);
            color: white;
        }

        /* Complaint Cards */
        .complaint-card {
            background: var(--bg-darker);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }

        .complaint-card:hover {
            transform: translateY(-3px);
        }

        /* Status Summary Cards */
        .status-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .status-card {
            background: var(--bg-darker);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .status-card:hover {
            transform: translateY(-3px);
        }

        .status-card.pending {
            border-left: 4px solid #f59e0b;
        }

        .status-card.verified {
            border-left: 4px solid #10b981;
        }

        .status-card.rejected {
            border-left: 4px solid #ef4444;
        }

        /* Add these modern scrollbar styles */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-darker);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-gradient);
            border-radius: var(--radius-full);
        }

        /* Add animation for page transitions */
        .page {
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Dark mode styles */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #0f172a;
                --bg-secondary: #1e293b;
                --bg-tertiary: #334155;
                --text-primary: #f8fafc;
                --text-secondary: #cbd5e1;
                --card-bg: rgba(30, 41, 59, 0.9);
                --card-border: rgba(255, 255, 255, 0.1);
            }
        }

        /* Search Details Page Styles */
        .search-page {
            padding: var(--space-4);
        }

        .search-box {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .search-box .form-control {
            flex: 1;
            font-size: 1rem;
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .search-box .btn {
            padding: 0.75rem 1.5rem;
            font-weight: 600;
        }

        /* Student Information Sections */
        .student-basic-info,
        .year-wise-section {
            background: var(--bg-darker);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .info-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.25rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .info-label {
            color: var(--text-muted);
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: block;
        }

        .info-value {
            color: var(--text-primary);
            font-size: 1.125rem;
            font-weight: 600;
        }

        /* Fee Details */
        .fee-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .fee-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.25rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.2s ease;
        }

        .fee-item:hover {
            transform: translateY(-2px);
        }

        .fee-label {
            color: var(--text-muted);
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .fee-value {
            color: var(--text-primary);
            font-size: 1.25rem;
            font-weight: 600;
        }

        /* Payment History Table */
        .payment-history {
            margin-top: 2rem;
        }

        .table-responsive {
            background: var(--bg-darker);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        .table th {
            background: var(--accent-color);
            color: var(--text-primary);
            font-weight: 600;
            padding: 1rem;
            text-align: left;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .table td {
            padding: 1rem;
            color: var(--text-secondary);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .table tr:hover td {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Status Badges */
        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-badge.verified {
            background: #dcfce7;
            color: #166534;
        }

        .status-badge.pending {
            background: #fef9c3;
            color: #854d0e;
        }

        .status-badge.rejected {
            background: #fee2e2;
            color: #991b1b;
        }

        /* Year Selector */
        .year-selector {
            margin-bottom: 2rem;
        }

        .year-selector select {
            width: 100%;
            max-width: 300px;
            padding: 0.75rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: var(--bg-darker);
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 500;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .search-box {
                flex-direction: column;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .fee-container {
                grid-template-columns: 1fr;
            }

            .table-responsive {
                margin: 0 -1rem;
                border-radius: 0;
            }
        }

        /* Add these modern toast message styles */
        .toast-message {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            background: var(--bg-darker);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            color: var(--text-primary);
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Search Details Page Styling */
        .search-page {
            background: linear-gradient(135deg, #f6f7ff 0%, #f0f9ff 100%);
            padding: 2rem;
            border-radius: 12px;
        }

        /* Search Box Styling */
        .search-box {
            background: var(--bg-darker);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .search-box .form-control {
            font-size: 1.1rem;
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 0.75rem 1rem;
        }

        .search-box .btn {
            background: linear-gradient(135deg, #4f46e5 0%, #3b82f6 100%);
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            transition: transform 0.2s;
        }

        .search-box .btn:hover {
            transform: translateY(-2px);
        }

        /* Student Information Section */
        .student-basic-info {
            background: var(--bg-darker);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .section-title i {
            color: #4f46e5;
        }

        /* Info Grid Items */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .info-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.2s;
        }

        .info-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .info-label {
            color: var(--text-muted);
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        .info-value {
            color: var(--text-primary);
            font-size: 1.25rem;
            font-weight: 600;
        }

        /* Fee Details Section */
        .fee-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .fee-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s;
        }

        .fee-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Status Badges */
        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.875rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-badge.verified {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .status-badge.pending {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .status-badge.rejected {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        /* Table Styling */
        .table-responsive {
            background: var(--bg-darker);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-top: 1.5rem;
        }

        .table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        .table th {
            background: linear-gradient(135deg, #4f46e5 0%, #3b82f6 100%);
            color: white;
            font-weight: 600;
            padding: 1rem;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .table td {
            padding: 1rem;
            color: var(--text-secondary);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.95rem;
        }

        .table tr:hover td {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Fee Type Breakdown */
        .fee-breakdown-section {
            background: var(--bg-darker);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-top: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .fee-breakdown-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.2s;
        }

        .fee-breakdown-item:hover {
            transform: translateX(5px);
            background: rgba(255, 255, 255, 0.08);
        }

        .fee-type {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .fee-amount {
            color: var(--text-primary);
            font-weight: 700;
            font-size: 1.1rem;
        }

        /* Year Selector */
        .year-selector {
            margin-bottom: 2rem;
        }

        .year-selector select {
            width: 100%;
            max-width: 300px;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: var(--bg-darker);
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
        }

        .year-selector select:focus {
            border-color: #4f46e5;
            outline: none;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .search-page {
                padding: 1rem;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .fee-container {
                grid-template-columns: 1fr;
            }

            .table-responsive {
                margin: 0 -1rem;
                border-radius: 0;
            }
        }

        /* Add animation for content appearance */
        .search-results {
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Add these styles to your existing CSS */

        /* Transaction Form Styles */
        .transaction-form-container {
            background: var(--bg-darker);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .transaction-form-title {
            color: var(--text-primary);
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 2rem;
            text-align: center;
            border-bottom: 3px solid #4f46e5;
            padding-bottom: 1rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-control {
            width: 100%;
            padding: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
            outline: none;
        }

        .form-control[readonly] {
            background-color: #f1f5f9;
            font-weight: 600;
            color: #1e293b;
        }

        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1em;
            padding-right: 2.5rem;
        }

        /* Readonly Field Styles */
        .readonly-field {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .readonly-label {
            color: var(--text-muted);
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
            display: block;
        }

        .readonly-value {
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 700;
        }

        /* Submit Button */
        .submit-btn {
            background: linear-gradient(135deg, #4f46e5, #3b82f6);
            color: white;
            font-size: 1.1rem;
            font-weight: 700;
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }
    </style>
</head>

<body>
    <!-- Login Form -->
    <div class="login-container" id="loginContainer">
        <div class="login-card">
            <h2 style="margin-bottom: 1.5rem;">Student Login</h2>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="rollNumber">Roll Number</label>
                    <input type="text" id="rollNumber" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" class="form-control" required>
                </div>
                <button type="submit" class="btn" style="width: 100%;">Login</button>

                <!-- Success/Error message container -->
                <div id="loginMessage" class="hidden"
                    style="margin-top: 1rem; padding: 0.75rem; border-radius: 5px; text-align: center;"></div>

                <!-- Register prompt container -->
                <div id="registerPrompt" class="hidden"
                    style="margin-top: 1rem; padding: 1rem; border-radius: 5px; background-color: #fff3cd; color: #856404; border-left: 4px solid #ffc107;">
                    <p><strong>Roll number not registered!</strong></p>
                    <p>Please contact your administrator to register your account first.</p>
                </div>

                <div style="margin-top: 1.5rem; text-align: center; font-size: 0.9rem; color: #666;">
                    <p>Use your roll number to log in.<br>Common password: vemuit@2008</p>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div class="main-app" id="mainApp">
        <!-- Sidebar Menu -->
        <div class="sidebar" id="sidebar">
            <a href="#" onclick="showPage('transaction')"><i class="fas fa-money-bill-wave"></i> Transaction Form</a>
            <a href="#" onclick="showPage('search')"><i class="fas fa-search"></i> Search Details</a>
         
            <a href="#" onclick="showPage('complaint')"><i class="fas fa-comment-alt"></i> Complaint</a>
            <a href="#" onclick="showPage('status')"><i class="fas fa-check-circle"></i> Status</a>
            <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </div>

        <!-- Menu Toggle Button -->
        <div class="menu-toggle" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </div>

        <!-- Content Area -->
        <div class="content-area" id="contentArea">
            <!-- Transaction Form Page -->
            <div class="page" id="transactionPage">
                <div class="card">
                    <h2>Student Transaction Form</h2>
                    <form id="transactionForm" onsubmit="submitTransaction(event)">
                        <div class="form-group">
                            <label>Student Name</label>
                            <input type="text" id="transName" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Roll Number</label>
                            <input type="text" id="transRollNumber" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Branch</label>
                            <input type="text" id="transBranch" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label for="updateAcademicYear">Academic Year</label>
                            <select id="updateAcademicYear" class="form-control" required>
                                <option value="">Select Academic Year</option>
                                <option>1st Year</option>
                                <option>2nd Year</option>
                                <option>3rd Year</option>
                                <option>4th Year</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Transaction ID</label>
                            <input type="text" id="transactionId" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>UTR/UPI Number</label>
                            <input type="text" id="utrNumber" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Date of Transaction</label>
                            <input type="date" id="transDate" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Paid Amount</label>
                            <input type="number" id="paidAmount" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Fee Type</label>
                            <select id="feeType" class="form-control" required>
                                <option value="">Select Fee Type</option>
                                <option value="tuition">Tuition Fee</option>
                                <option value="hostel">Hostel Fee</option>
                                <option value="bus">Bus Fee</option>
                                <option value="university">University Fee</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Mobile Number</label>
                            <input type="tel" id="mobileNumber" class="form-control" required>
                        </div>
                        <button type="submit" class="btn">Submit</button>

                        <div id="transactionInfoDisplay" class="hidden"
                            style="margin-top: 2rem; border-top: 2px solid #e1e1e1; padding-top: 2rem;">
                            <h3>Transaction Details</h3>
                            <table class="table">
                                <tbody id="transactionInfoTable"></tbody>
                            </table>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Search Details Page -->
            <div class="page" id="searchPage">
                <div class="search-page">
                    <div class="card">
                        <h2 class="section-title">
                            <i class="fas fa-info-circle"></i>
                            Student Information
                        </h2>
                        
                        <div class="search-box">
                            <input 
                                type="text" 
                                id="searchRollNumber" 
                                class="form-control" 
                                placeholder="Enter Roll Number"
                                value=""
                            >
                            <button onclick="searchStudent()" class="btn btn-primary">
                                <i class="fas fa-search"></i> Search
                            </button>
                        </div>

                        <div id="searchResults" class="hidden">
                            <!-- Student Basic Info -->
                            <div class="student-basic-info">
                                <h3 class="section-title">
                                    <i class="fas fa-user-graduate"></i>
                                    Student Details
                                </h3>
                                <div id="basicInfo" class="info-grid"></div>
                            </div>

                            <!-- Year-wise Details -->
                            <div class="year-wise-section">
                                <h3 class="section-title">
                                    <i class="fas fa-calendar-alt"></i>
                                    Year-wise Details
                                </h3>
                                
                                <div class="year-selector">
                                    <select id="yearSelect" class="form-control" onchange="updateYearDetails()">
                                        <option value="">Select Year</option>
                                    </select>
                                </div>

                                <!-- Fee Summary -->
                                <div class="fee-summary">
                                    <h4 class="section-title">
                                        <i class="fas fa-money-bill-wave"></i>
                                        Fee Details
                                    </h4>
                                    <div id="feeInfo" class="fee-container"></div>
                                </div>

                                <!-- Payment History -->
                                <div class="payment-history">
                                    <h4 class="section-title">
                                        <i class="fas fa-history"></i>
                                        Payment History
                                    </h4>
                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead>
                                                <tr>
                                                    <th>Date</th>
                                                    <th>Bill Number</th>
                                                    <th>Amount</th>
                                                    <th>Fee Type</th>
                                                    <th>Status</th>
                                                </tr>
                                            </thead>
                                            <tbody id="paymentHistoryTable"></tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Fee Type Breakdown -->
                                <div class="fee-breakdown-section">
                                    <h4 class="section-title">
                                        <i class="fas fa-chart-pie"></i>
                                        Fee Type Breakdown
                                    </h4>
                                    <div id="feeTypeBreakdown" class="fee-type-details"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Complaint Page -->
            <div class="page" id="complaintPage">
                <div class="card">
                    <h2>Submit Complaint</h2>
                    <form id="complaintForm" onsubmit="submitComplaint(event)">
                        <div class="form-group">
                            <label>Subject</label>
                            <input type="text" id="complaintSubject" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="complaintDesc" class="form-control" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="btn">Submit Complaint</button>

                        <!-- Add this new section to show submitted complaints -->
                        <div id="submittedComplaints" class="hidden" style="margin-top: 2rem;">
                            <h3>Your Complaints</h3>
                            <div id="complaintsList"></div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Status Page -->
            <div class="page" id="statusPage">
                <div class="card">
                    <h2>Transaction Status</h2>
                    <div class="status-container">
                        <div class="status-filters">
                            <select id="statusFilter" class="form-control" onchange="filterTransactions(this.value)">
                                <option value="all">All Transactions</option>
                                <option value="pending">Pending Verification</option>
                                <option value="verified">Verified</option>
                                <option value="rejected">Rejected</option>
                            </select>
                        </div>
                        <div id="transactionsList" class="transaction-list">
                            <!-- Transactions will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Transaction Status Section -->
    <div id="transactionStatus" class="hidden">
        <div class="card">
            <h3>Transaction Status</h3>
            <div id="statusContent"></div>
        </div>
    </div>

    <!-- Add Student Information Section -->
    <div id="studentInfo" class="hidden">
        <div class="card">
            <h3>Student Information</h3>
            <div class="search-box">
                <input type="text" id="searchRollNumber" placeholder="Enter Roll Number">
                <button onclick="searchStudent()" class="btn btn-primary">
                    <i class="fas fa-search"></i> Search
                </button>
            </div>

            <div id="studentDetails" class="hidden">
                <!-- Student details will be populated here -->
            </div>
        </div>
    </div>

    <!-- Add Transaction Form -->
    <div id="transactionForm" class="hidden">
        <div class="card">
            <h3>Submit Fee Transaction</h3>
            <form onsubmit="submitTransaction(event)">
                <div class="form-group">
                    <label>Roll Number</label>
                    <input type="text" id="transRollNumber" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Amount</label>
                    <input type="number" id="transAmount" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Fee Type</label>
                    <select id="transFeeType" class="form-control" required>
                        <option value="">Select Fee Type</option>
                        <option>Tuition Fee</option>
                        <option>Hostel Fee</option>
                        <option>Bus Fee</option>
                    </select>
                    </button>
            </form>
        </div>
    </div>

    <!-- Transaction Status -->
    <div id="statusPage" class="hidden">
        <div class="card">
            <h3>Transaction Status</h3>
            <div id="statusContent"></div>
        </div>
    </div>

    <!-- Student Information -->
    <div id="studentInfo" class="hidden">
        <div class="card">
            <h3>Student Information</h3>
            <div class="search-box">
                <input type="text" id="searchRollNumber" placeholder="Enter Roll Number">
                <button onclick="searchStudent()" class="btn btn-primary">Search</button>
            </div>
            <div id="studentDetails" class="hidden"></div>
        </div>
    </div>

    <script>
        // Mock transaction history array
        const transactionHistory = [];

        // Function to handle login with Flask backend
        async function handleLogin(event) {
            event.preventDefault();
            const rollNumber = document.getElementById('rollNumber').value;
            const password = document.getElementById('password').value;
            const loginMessage = document.getElementById('loginMessage');
            const registerPrompt = document.getElementById('registerPrompt');

            // Reset messages
            loginMessage.classList.add('hidden');
            registerPrompt.classList.add('hidden');

            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        rollNumber: rollNumber,
                        password: password
                    })
                });

                const data = await response.json();

                if (data.success) {
                    // Show success message
                    loginMessage.textContent = "Login successful! Redirecting...";
                    loginMessage.style.backgroundColor = "#d4edda";
                    loginMessage.style.color = "#155724";
                    loginMessage.classList.remove('hidden');

                    // Store student data in session
                    sessionStorage.setItem('currentStudent', JSON.stringify(data.student));

                    // Delay to show the success message
                    setTimeout(() => {
                        // Update UI
                        document.getElementById('loginContainer').style.display = 'none';
                        document.getElementById('mainApp').style.display = 'block';

                        // Populate student data
                        populateStudentData(data.student);

                        // Show transaction page
                        showPage('transaction');
                    }, 1000);
                } else {
                    // Show error message
                    loginMessage.textContent = data.message || "Login failed. Please try again.";
                    loginMessage.style.backgroundColor = "#f8d7da";
                    loginMessage.style.color = "#721c24";
                    loginMessage.classList.remove('hidden');
                }
            } catch (error) {
                console.error('Login error:', error);
                loginMessage.textContent = "Network error. Please check your connection.";
                loginMessage.style.backgroundColor = "#f8d7da";
                loginMessage.style.color = "#721c24";
                loginMessage.classList.remove('hidden');
            }
        }

        // These functions are kept as empty placeholders for compatibility
        function initializeDemoDatabase() {
            // No longer creating sample data - will use only the real data from employlogin
            console.log("Using existing student data from employlogin");
        }

        function initializeComplaintsDatabase() {
            // No longer creating sample complaints data
            console.log("Using existing complaints data if available");
        }

        function initializeStatusPage() {
            // Not adding mock transactions anymore
            console.log("Transaction status initialized");
            // We'll leave the transactionHistory array empty
            // Instead of adding mock data, we'll rely on actual data from localStorage
        }

        // Function to populate student data in the UI after login
        function populateStudentData(student) {
            document.getElementById('transName').value = student.name;
            document.getElementById('transRollNumber').value = student.rollNumber;
            document.getElementById('transBranch').value = student.branch;

            // Set current academic year based on student's year
            const academicYear = document.getElementById('updateAcademicYear');
            if (student.academicYear) {
                academicYear.value = student.academicYear;
            }
        }

        // Function to handle API errors
        function handleApiError(error) {
            console.error('API Error:', error);
            alert('An error occurred. Please try again later.');
        }

        // Updated searchStudent function with Flask backend
        async function searchStudent() {
            const rollNumber = document.getElementById('searchRollNumber').value.trim();
            const resultsDiv = document.getElementById('searchResults');
            
            if (!rollNumber) {
                showError('Please enter a roll number');
                return;
            }

            try {
                const response = await fetch(`/api/search/student/${rollNumber}`);
                const data = await response.json();

                if (!data.success) {
                    showError(data.message || 'Student not found');
                    resultsDiv.classList.add('hidden');
                    return;
                }

                const student = data.student;

                // Display basic information
                displayBasicInfo(student);

                // Get unique academic years (assuming 4 years)
                const years = ['1st Year', '2nd Year', '3rd Year', '4th Year'];
                populateYearSelector(years);

                // Show first year's details by default
                if (years.length > 0) {
                    document.getElementById('yearSelect').value = years[0];
                    updateYearDetails();
                }

                resultsDiv.classList.remove('hidden');

            } catch (error) {
                console.error('Error:', error);
                showError('Error fetching student information');
            }
        }

        function displayBasicInfo(student) {
            document.getElementById('basicInfo').innerHTML = `
                <div class="info-item">
                    <span class="info-label">Name</span>
                    <span class="info-value">${student.name}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Roll Number</span>
                    <span class="info-value">${student.rollNumber}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Branch</span>
                    <span class="info-value">${student.branch}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Category</span>
                    <span class="info-value">${student.category}</span>
                </div>
            `;
        }

        function populateYearSelector(years) {
            const yearSelect = document.getElementById('yearSelect');
            yearSelect.innerHTML = `
                <option value="">Select Year</option>
                ${years.map(year => `<option value="${year}">${year}</option>`).join('')}
            `;
        }

        function updateYearDetails() {
            const rollNumber = document.getElementById('searchRollNumber').value.trim();
            const selectedYear = document.getElementById('yearSelect').value;
            if (!rollNumber || !selectedYear) return;
            try {
                const transactions = JSON.parse(localStorage.getItem('studentTransactions') || '[]');
                const studentDB = JSON.parse(localStorage.getItem('studentDatabase') || '[]');
                const student = studentDB.find(s => s.rollNumber === rollNumber && s.academicYear === selectedYear);
                if (!student) {
                    document.getElementById('feeInfo').innerHTML = '<p>No details available for selected year</p>';
                    document.getElementById('paymentHistoryTable').innerHTML = '';
                    document.getElementById('feeTypeBreakdown').innerHTML = '';
                    return;
                }
                // Get all verified transactions for this student and year
                const verifiedTransactions = transactions.filter(t =>
                    t.status === 'verified' &&
                    t.rollNumber === rollNumber &&
                    t.academicYear === selectedYear
                );
                // Calculate total paid amount including regular payments and verified transactions
                const regularPaymentsTotal = student.payments ?
                    student.payments.reduce((sum, p) => sum + parseFloat(p.amount), 0) : 0;
                const verifiedPaymentsTotal = verifiedTransactions.reduce((sum, t) =>
                    sum + parseFloat(t.paidAmount), 0);
                const totalPaidAmount = regularPaymentsTotal + verifiedPaymentsTotal;
                const pendingAmount = student.totalAmount - totalPaidAmount;
                // Fee summary
                document.getElementById('feeInfo').innerHTML = `
                    <div class="fee-item">
                        <span class="info-label">Total Fee</span>
                        <span class="info-value">${student.totalAmount.toFixed(2)}</span>
                    </div>
                    <div class="fee-item">
                        <span class="info-label">Paid Amount</span>
                        <span class="info-value">${totalPaidAmount.toFixed(2)}</span>
                    </div>
                    <div class="fee-item">
                        <span class="info-label">Pending Amount</span>
                        <span class="info-value">${pendingAmount.toFixed(2)}</span>
                    </div>
                `;
                // Payment history (combine regular and verified)
                const allPayments = [
                    ...(student.payments || []).map(p => ({
                        date: p.date,
                        billNumber: p.billNumber,
                        amount: p.amount,
                        feeType: p.feeType,
                        status: 'Regular'
                    })),
                    ...verifiedTransactions.map(t => ({
                        date: t.transDate,
                        billNumber: t.billNumber,
                        amount: t.paidAmount,
                        feeType: t.feeType,
                        status: 'Verified'
                    }))
                ];
                const historyHTML = allPayments.length ?
                    allPayments.sort((a, b) => new Date(b.date) - new Date(a.date)).map(payment => `
                        <tr>
                            <td>${new Date(payment.date).toLocaleDateString()}</td>
                            <td>${payment.billNumber || '-'}</td>
                            <td>${parseFloat(payment.amount).toFixed(2)}</td>
                            <td>${payment.feeType}</td>
                            <td>
                                <span class="status-badge ${payment.status === 'Verified' ? 'verified' : 'regular'}">
                                    <i class="fas fa-check-circle"></i> ${payment.status}
                                </span>
                            </td>
                        </tr>
                    `).join('') :
                    '<tr><td colspan="5" class="text-center">No payment history available</td></tr>';
                document.getElementById('paymentHistoryTable').innerHTML = historyHTML;
                // Fee type breakdown
                const feeTypes = {};
                allPayments.forEach(payment => {
                    feeTypes[payment.feeType] = (feeTypes[payment.feeType] || 0) + parseFloat(payment.amount);
                });
                const breakdownHTML = Object.keys(feeTypes).length ?
                    Object.entries(feeTypes).map(([type, amount]) => `
                        <div class="fee-breakdown-item">
                            <span class="fee-type">${type}</span>
                            <span class="fee-amount">${amount.toFixed(2)}</span>
                        </div>
                    `).join('') :
                    '<p class="text-center">No fee breakdown available</p>';
                document.getElementById('feeTypeBreakdown').innerHTML = breakdownHTML;
            } catch (error) {
                console.error('Error:', error);
                alert('Error while updating year details. Please try again.');
            }
        }

        // Add event listeners
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('searchRollNumber');
            if (searchInput) {
                // Add enter key support
                searchInput.addEventListener('keypress', function(event) {
                    if (event.key === 'Enter') {
                        searchStudent();
                    }
                });

                // Auto-populate for logged-in student
                const currentStudent = JSON.parse(sessionStorage.getItem('currentStudent'));
                if (currentStudent) {
                    searchInput.value = currentStudent.rollNumber;
                    searchStudent();
                }
            }
        });

        // Add event listener for Enter key
        document.getElementById('searchRollNumber').addEventListener('keypress', function (event) {
            if (event.key === 'Enter') {
                searchStudent();
            }
        });

        // Call this when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            // We're not initializing demo data anymore
            // Just check if user is already logged in
            const savedStudent = sessionStorage.getItem('currentStudent');
            if (savedStudent) {
                const student = JSON.parse(savedStudent);
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                populateStudentData(student);
                showPage('transaction');
            }

            // Initialize the UI
            if (window.innerWidth > 768) {
                toggleSidebar();
            }
        });

        // Update logout function with Flask backend
        async function logout() {
            if (confirm('Are you sure you want to logout?')) {
                try {
                    const response = await fetch('/api/logout');
                    const data = await response.json();
                    
                    if (data.success) {
                        sessionStorage.removeItem('currentStudent');
                        document.getElementById('mainApp').style.display = 'none';
                        document.getElementById('loginContainer').style.display = 'flex';
                        document.getElementById('loginForm').reset();
                        document.getElementById('loginMessage').textContent = '';
                        document.getElementById('registerPrompt').textContent = '';
                    }
                } catch (error) {
                    console.error('Logout error:', error);
                    // Still logout locally even if server logout fails
                    sessionStorage.removeItem('currentStudent');
                    document.getElementById('mainApp').style.display = 'none';
                    document.getElementById('loginContainer').style.display = 'flex';
                    document.getElementById('loginForm').reset();
                    document.getElementById('loginMessage').textContent = '';
                    document.getElementById('registerPrompt').textContent = '';
                }
            }
        }

        // Transaction form submission with Flask backend
        async function submitTransaction(event) {
            event.preventDefault();

            try {
                // Get current student
                const currentStudent = JSON.parse(sessionStorage.getItem('currentStudent'));
                if (!currentStudent) {
                    throw new Error('Please log in again');
                }

                // Get form data
                const amount = parseFloat(document.getElementById('paidAmount').value);
                const paymentMethod = document.getElementById('feeType').value;
                const description = `Fee Type: ${paymentMethod}, UTR: ${document.getElementById('utrNumber').value}, Date: ${document.getElementById('transDate').value}`;

                // Validate form data
                if (!amount || !paymentMethod || !document.getElementById('utrNumber').value || !document.getElementById('transDate').value) {
                    throw new Error('Please fill all required fields');
                }

                // Submit to Flask backend
                const response = await fetch('/api/transactions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        amount: amount,
                        paymentMethod: paymentMethod,
                        description: description
                    })
                });

                const data = await response.json();

                if (data.success) {
                    // Show success message
                    showSuccessMessage('Transaction submitted successfully! Awaiting verification.');

                    // Display transaction details
                    displayTransactionConfirmation({
                        transactionId: data.transaction.transaction_id,
                        paidAmount: data.transaction.amount,
                        feeType: data.transaction.payment_method,
                        status: data.transaction.status
                    });

                    // Reset form
                    document.getElementById('transactionForm').reset();

                    // Update status page
                    filterTransactions('all');
                } else {
                    throw new Error(data.message || 'Transaction submission failed');
                }

            } catch (error) {
                alert(error.message);
            }
        }

        function displayTransactionConfirmation(transaction) {
            const infoDisplay = document.getElementById('transactionInfoDisplay');
            infoDisplay.innerHTML = `
                <div class="transaction-card">
                    <h3>Transaction Details</h3>
                    <div class="transaction-details">
                        <div class="detail-group">
                            <span class="detail-label">Transaction ID</span>
                            <span class="detail-value">${transaction.transactionId}</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Amount</span>
                            <span class="detail-value">${transaction.paidAmount.toFixed(2)}</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Fee Type</span>
                            <span class="detail-value">${transaction.feeType}</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Academic Year</span>
                            <span class="detail-value">${transaction.academicYear}</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">UTR Number</span>
                            <span class="detail-value">${transaction.utrNumber}</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Date</span>
                            <span class="detail-value">${new Date(transaction.transDate).toLocaleDateString()}</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Status</span>
                            <span class="status-badge pending">Pending Verification</span>
                        </div>
                    </div>
                </div>
            `;
            infoDisplay.classList.remove('hidden');
        }

        // Complaint form submission with Flask backend
        async function submitComplaint(event) {
            event.preventDefault();

            // Get current student's information from sessionStorage
            const currentStudent = JSON.parse(sessionStorage.getItem('currentStudent'));
            if (!currentStudent) {
                alert('You must be logged in to submit a complaint');
                return;
            }

            const subject = document.getElementById('complaintSubject').value;
            const message = document.getElementById('complaintDesc').value;

            if (!subject || !message) {
                alert('Please fill all required fields');
                return;
            }

            try {
                const response = await fetch('/api/complaints', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        subject: subject,
                        message: message
                    })
                });

                const data = await response.json();

                if (data.success) {
                    // Show success message
                    alert('Complaint submitted successfully!');
                    event.target.reset();

                    // Display the complaint
                    displayStudentComplaints();
                } else {
                    alert(data.message || 'Complaint submission failed');
                }
            } catch (error) {
                console.error('Complaint submission error:', error);
                alert('Network error. Please try again.');
            }
        }

        function displayStudentComplaints() {
            // Get the current student's roll number from session storage
            const currentStudent = JSON.parse(sessionStorage.getItem('currentStudent'));
            if (!currentStudent) {
                return;
            }

            const rollNumber = currentStudent.rollNumber;

            // Get complaints from localStorage
            const complaints = JSON.parse(localStorage.getItem('studentComplaints') || '[]');
            const studentComplaints = complaints.filter(c => c.rollNumber === rollNumber);

            const complaintsDiv = document.getElementById('complaintsList');
            const submittedComplaints = document.getElementById('submittedComplaints');

            if (studentComplaints.length === 0) {
                complaintsDiv.innerHTML = '<p>No complaints submitted yet.</p>';
            } else {
                complaintsDiv.innerHTML = studentComplaints.map(complaint => `
                    <div class="complaint-card" style="margin-bottom: 1rem; padding: 1rem; border: 1px solid #e1e1e1; border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <h4 style="margin: 0;">${complaint.subject}</h4>
                            <span class="badge ${complaint.status === 'pending' ? 'status-pending' :
                        complaint.status === 'resolved' ? 'status-verified' :
                            'status-rejected'}">${complaint.status}</span>
                                </div>
                        <p>${complaint.description}</p>
                        <div style="color: #666; font-size: 0.9rem;">
                            Submitted on: ${new Date(complaint.timestamp).toLocaleString()}
                                </div>
                        ${complaint.response ? `
                            <div style="margin-top: 1rem; padding: 0.5rem; background: #f5f5f5; border-radius: 4px;">
                                <h5 style="margin-top: 0;">Response:</h5>
                                <p>${complaint.response}</p>
                            </div>
                        ` : ''}
                </div>
            `).join('');
            }

            submittedComplaints.classList.remove('hidden');
        }

        // Transaction status check
        function checkTransactionStatus() {
            const status = JSON.parse(localStorage.getItem('transactionStatus'));
            if (status) {
                const statusDiv = document.getElementById('transactionStatus');
                const content = document.getElementById('statusContent');

                statusDiv.classList.remove('hidden');
                content.innerHTML = `
                    <div class="status-card ${status.status}">
                        <h4>Status: ${status.status.toUpperCase()}</h4>
                        ${status.reason ? `<p>Reason: ${status.reason}</p>` : ''}
                        <p>Updated on: ${new Date(status.date).toLocaleString()}</p>
                    </div>
                `;
            }
        }

        // Navigation functions
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(pageId + 'Page').classList.add('active');

            if (pageId === 'status') {
                filterTransactions('all');
            } else if (pageId === 'complaint') {
                displayStudentComplaints();
            }

            if (window.innerWidth <= 768) {
                toggleSidebar();
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const contentArea = document.getElementById('contentArea');
            sidebar.classList.toggle('active');
            contentArea.classList.toggle('shifted');
        }

        // Helper function for status text
        function getStatusText(status) {
            switch (status) {
                case 'pending':
                    return 'Pending Verification';
                case 'verified':
                    return 'Verified';
                case 'rejected':
                    return 'Rejected';
                default:
                    return status.charAt(0).toUpperCase() + status.slice(1);
            }
        }

        function filterTransactions(status) {
            try {
                const currentStudent = JSON.parse(sessionStorage.getItem('currentStudent'));
                if (!currentStudent) {
                    throw new Error('Please log in again');
                }

                const transactions = JSON.parse(localStorage.getItem('studentTransactions') || '[]')
                    .filter(t => t.rollNumber === currentStudent.rollNumber &&
                        (status === 'all' || t.status === status));

                displayTransactions(transactions);
                updateStatusSummary(transactions);

            } catch (error) {
                alert(error.message);
            }
        }

        function displayTransactions(transactions) {
            const container = document.getElementById('transactionsList');

            if (!transactions || transactions.length === 0) {
                container.innerHTML = '<p class="text-center">No transactions found</p>';
                return;
            }

            container.innerHTML = transactions
                .sort((a, b) => new Date(b.transDate) - new Date(a.transDate))
                .map(t => `
                    <div class="transaction-card">
                        <div class="transaction-header">
                            <h4>Transaction ID: ${t.transactionId}</h4>
                            <span class="status-badge ${t.status}">
                                ${t.status.toUpperCase()}
                            </span>
                        </div>
                        <div class="transaction-details">
                            <div class="detail-group">
                                <span class="detail-label">Amount:</span>
                                <span class="detail-value">${t.paidAmount}</span>
                            </div>
                            <div class="detail-group">
                                <span class="detail-label">Date:</span>
                                <span class="detail-value">
                                    ${new Date(t.transDate).toLocaleDateString()}
                                </span>
                            </div>
                            <div class="detail-group">
                                <span class="detail-label">Fee Type:</span>
                                <span class="detail-value">${t.feeType}</span>
                            </div>
                            <div class="detail-group">
                                <span class="detail-label">Academic Year:</span>
                                <span class="detail-value">${t.academicYear}</span>
                            </div>
                            ${t.billNumber ? `
                                <div class="detail-group">
                                    <span class="detail-label">Bill Number:</span>
                                    <span class="detail-value">${t.billNumber}</span>
                                </div>
                            ` : ''}
                            ${t.status === 'rejected' ? `
                                <div class="rejection-reason">
                                    <strong>Rejection Reason:</strong>
                                    <p>${t.verificationComment}</p>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `).join('');
        }

        function updateStatusSummary(transactions) {
            const summary = transactions.reduce((acc, t) => {
                acc[t.status] = (acc[t.status] || 0) + 1;
                return acc;
            }, {});

            document.getElementById('statusContent').innerHTML = `
                <div class="status-summary">
                    <div class="status-card ${summary.pending ? 'pending' : ''}">
                        <h4>Pending</h4>
                        <p>${summary.pending || 0}</p>
                    </div>
                    <div class="status-card ${summary.verified ? 'verified' : ''}">
                        <h4>Verified</h4>
                        <p>${summary.verified || 0}</p>
                    </div>
                    <div class="status-card ${summary.rejected ? 'rejected' : ''}">
                        <h4>Rejected</h4>
                        <p>${summary.rejected || 0}</p>
                    </div>
                </div>
            `;
        }

        function showSuccessMessage(message) {
            const toastMessage = document.createElement('div');
            toastMessage.className = 'toast-message success';
            toastMessage.textContent = message;
            document.body.appendChild(toastMessage);

            setTimeout(() => {
                toastMessage.remove();
            }, 3000);
        }

        // Function to check authorization
        function isAuthorized(rollNumber) {
            const currentStudent = JSON.parse(sessionStorage.getItem('currentStudent'));
            return currentStudent && currentStudent.rollNumber === rollNumber;
        }

        // Function to display student information with multiple year details
        function displayStudentInformation(rollNumber) {
            try {
                if (!isAuthorized(rollNumber)) {
                    throw new Error('You are not authorized to view this information');
                }

                const studentDB = JSON.parse(localStorage.getItem('studentDatabase') || '[]');
                const transactions = JSON.parse(localStorage.getItem('studentTransactions') || '[]');
                const student = studentDB.find(s => s.rollNumber === rollNumber);

                if (!student) {
                    throw new Error('Student not found');
                }

                // Get all years' transactions
                const years = ['1st Year', '2nd Year', '3rd Year', '4th Year'];
                const yearWiseData = years.map(year => {
                    const yearTransactions = transactions.filter(t => 
                        t.rollNumber === rollNumber && 
                        t.academicYear === year &&
                        t.status === 'verified'
                    );

                    return {
                        year,
                        transactions: yearTransactions,
                        totalPaid: yearTransactions.reduce((sum, t) => sum + parseFloat(t.paidAmount), 0),
                        feeBreakdown: yearTransactions.reduce((acc, t) => {
                            acc[t.feeType] = (acc[t.feeType] || 0) + parseFloat(t.paidAmount);
                            return acc;
                        }, {})
                    };
                });

                // Update UI with student basic info and all years' data
                document.getElementById('searchResults').innerHTML = `
                    <div class="student-profile-section">
                        <h3 class="section-title"><i class="fas fa-user-graduate"></i> Student Profile</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Name</span>
                                <span class="info-value">${student.name}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Roll Number</span>
                                <span class="info-value">${student.rollNumber}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Branch</span>
                                <span class="info-value">${student.branch}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Current Year</span>
                                <span class="info-value">${student.academicYear}</span>
                            </div>
                        </div>
                    </div>

                    ${yearWiseData.map(yearData => `
                        <div class="year-wise-section">
                            <h3 class="section-title">
                                <i class="fas fa-calendar-alt"></i> ${yearData.year}
                            </h3>
                            
                            <div class="fee-summary">
                                <h4 class="section-title">
                                    <i class="fas fa-money-bill-wave"></i> Fee Summary
                                </h4>
                                <div class="fee-details">
                                    <div class="fee-item">
                                        <span class="info-label">Total Paid (Verified)</span>
                                        <span class="info-value">${yearData.totalPaid.toFixed(2)}</span>
                                    </div>
                                </div>
                            </div>

                            ${Object.keys(yearData.feeBreakdown).length > 0 ? `
                                <div class="fee-breakdown-section">
                                    <h4 class="section-title">
                                        <i class="fas fa-chart-pie"></i> Fee Type Breakdown
                                    </h4>
                                    <div class="fee-type-details">
                                        ${Object.entries(yearData.feeBreakdown).map(([type, amount]) => `
                                            <div class="fee-breakdown-item">
                                                <span class="fee-type">${type}</span>
                                                <span class="fee-amount">${amount.toFixed(2)}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}

                            <div class="payment-history">
                                <h4 class="section-title">
                                    <i class="fas fa-history"></i> Verified Payments
                                </h4>
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Transaction ID</th>
                                                <th>Amount</th>
                                                <th>Fee Type</th>
                                                <th>Bill Number</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${yearData.transactions.length ? 
                                                yearData.transactions
                                                    .sort((a, b) => new Date(b.transDate) - new Date(a.transDate))
                                                    .map(payment => `
                                                        <tr>
                                                            <td>${new Date(payment.transDate).toLocaleDateString()}</td>
                                                            <td>${payment.transactionId}</td>
                                                            <td>${parseFloat(payment.paidAmount).toFixed(2)}</td>
                                                            <td>${payment.feeType}</td>
                                                            <td>${payment.billNumber || '-'}</td>
                                                        </tr>
                                                    `).join('') :
                                                '<tr><td colspan="5" class="text-center">No verified payments for this year</td></tr>'
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                `;

                document.getElementById('searchResults').classList.remove('hidden');

            } catch (error) {
                console.error('Error:', error);
                showError(error.message);
            }
        }

        // Helper function to show errors
        function showError(message) {
            const toast = document.createElement('div');
            toast.className = 'toast-message error';
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // Add inside your existing <script> tag
        function searchStudentDetails() {
            const rollNumber = document.getElementById('searchDetailsRollNumber').value.trim();
            const resultsDiv = document.getElementById('studentDetailsResults');
            const yearSelect = document.getElementById('detailsYearSelect');

            if (!rollNumber) {
                showError('Please enter a roll number');
                return;
            }

            try {
                // Find all entries for the student
                const studentEntries = studentDatabase.filter(s => s.rollNumber === rollNumber);

                if (studentEntries.length === 0) {
                    showError('No student found with this roll number');
                    resultsDiv.classList.add('hidden');
                    return;
                }

                // Only allow students to view their own details
                const currentStudent = JSON.parse(sessionStorage.getItem('currentStudent'));
                if (currentStudent.rollNumber !== rollNumber) {
                    showError('You can only view your own details');
                    return;
                }

                // Get the latest entry for basic info
                const latestEntry = studentEntries[studentEntries.length - 1];

                // Display basic information
                document.getElementById('studentDetailsBasicInfo').innerHTML = `
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Name</span>
                            <span class="info-value">${latestEntry.name || 'N/A'}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Roll Number</span>
                            <span class="info-value">${latestEntry.rollNumber || 'N/A'}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Branch</span>
                            <span class="info-value">${latestEntry.branch || 'N/A'}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Category</span>
                            <span class="info-value">${latestEntry.category || 'N/A'}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Academic Year</span>
                            <span class="info-value">${latestEntry.academicYear || 'N/A'}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Total Amount</span>
                            <span class="info-value">${(latestEntry.totalAmount || 0).toFixed(2)}</span>
                        </div>
                    </div>
                `;

                // Populate year selector
                const years = [...new Set(studentEntries.map(entry => entry.academicYear))];
                yearSelect.innerHTML = `
                    <option value="">Select Year</option>
                    ${years.map(year => `<option value="${year}">${year}</option>`).join('')}
                `;

                // Show results and select first year by default
                resultsDiv.classList.remove('hidden');
                if (years.length > 0) {
                    yearSelect.value = years[0];
                    updateDetailsYearInfo();
                }

            } catch (error) {
                console.error('Error:', error);
                showError('Error fetching student details');
            }
        }

        // Add this function in studentlogin.html script section
        function loadSearchDetailsFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const rollNumber = urlParams.get('rollNumber');
            
            if (rollNumber) {
                document.getElementById('searchDetailsRollNumber').value = rollNumber;
                searchStudentDetails(); // Automatically search with the roll number from URL
            }
        }

        // Add this to your DOMContentLoaded event listener
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchDetailsRollNumber');
            
            // Add Enter key support
            searchInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    searchStudentDetails();
                }
            });

            // Add input validation
            searchInput.addEventListener('input', function(event) {
                const value = event.target.value.trim();
                event.target.value = value.replace(/[^a-zA-Z0-9]/g, '');
            });
            
            // Load search details from URL if available
            loadSearchDetailsFromURL();
        });
    </script>
</body>

</html>